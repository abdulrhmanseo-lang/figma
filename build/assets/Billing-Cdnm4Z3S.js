import{c as g,r as c,j as e,a as h,m as p}from"./index-mGwfGQYQ.js";import{X as b}from"./x-BRS87iRj.js";import{P as y}from"./plus-B5-QUGQk.js";import{S as j}from"./search-Sd1l6yxc.js";import{E as N}from"./eye-Dw4GrOfy.js";import{D as f}from"./download-D2AM5o62.js";import"./createLucideIcon-_jMiD3q_.js";function v({isOpen:n,onClose:i}){const{contracts:d}=g(),[a,o]=c.useState({contractId:"",tenantName:"",amount:0,tax:0}),x=s=>{const r=d.find(t=>t.id===s);if(r){const t=r.rentAmount*.15;o({contractId:s,tenantName:r.tenantName,amount:r.rentAmount,tax:t})}},m=s=>{s.preventDefault(),i(),alert("تم إنشاء الفاتورة بنجاح")};return n?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-md w-full",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[e.jsx("h2",{className:"text-2xl font-bold",style:{color:"#0A2A43"},children:"تسجيل دفعة جديدة"}),e.jsx("button",{onClick:i,className:"p-2 hover:bg-gray-100 rounded-lg",children:e.jsx(b,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:m,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"العقد"}),e.jsxs("select",{required:!0,onChange:s=>x(s.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400",children:[e.jsx("option",{value:"",children:"اختر العقد"}),d.filter(s=>s.status==="active").map(s=>e.jsxs("option",{value:s.id,children:[s.tenantName," - ",s.unitNo]},s.id))]})]}),a.tenantName&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"المستأجر"}),e.jsx("input",{type:"text",disabled:!0,value:a.tenantName,className:"w-full px-4 py-2 border border-gray-300 rounded-lg bg-gray-50"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"المبلغ"}),e.jsx("input",{type:"number",disabled:!0,value:a.amount,className:"w-full px-4 py-2 border border-gray-300 rounded-lg bg-gray-50"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الضريبة (15%)"}),e.jsx("input",{type:"number",disabled:!0,value:a.tax,className:"w-full px-4 py-2 border border-gray-300 rounded-lg bg-gray-50"})]})]}),e.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"الإجمالي"}),e.jsxs("p",{className:"text-2xl font-bold",style:{color:"#0A2A43"},children:[(a.amount+a.tax).toLocaleString()," ر.س"]})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"submit",disabled:!a.contractId,className:"flex-1 px-6 py-3 bg-gradient-to-r from-blue-500 to-cyan-500 text-white rounded-lg hover:shadow-lg transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:"إنشاء الفاتورة"}),e.jsx("button",{type:"button",onClick:i,className:"px-6 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors",children:"إلغاء"})]})]})]})}):null}function E(){const{invoices:n}=g(),i=h(),[d,a]=c.useState(""),[o,x]=c.useState("all"),[m,s]=c.useState(!1),r=n.filter(t=>{const l=t.tenantName.toLowerCase().includes(d.toLowerCase())||t.invoiceNumber.toLowerCase().includes(d.toLowerCase()),u=o==="all"||t.status===o;return l&&u});return e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",style:{color:"#0A2A43"},children:"الفواتير والدفع"}),e.jsx("p",{className:"text-gray-600",children:"إدارة الفواتير والمدفوعات"})]}),e.jsxs("button",{onClick:()=>s(!0),className:"mt-4 md:mt-0 px-6 py-3 bg-gradient-to-r from-blue-500 to-cyan-500 text-white rounded-xl hover:shadow-lg transition-all duration-200 flex items-center gap-2",children:[e.jsx(y,{className:"w-5 h-5"}),e.jsx("span",{children:"تسجيل دفعة جديدة"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"إجمالي الفواتير"}),e.jsxs("p",{className:"text-3xl font-bold",style:{color:"#0A2A43"},children:[n.reduce((t,l)=>t+l.total,0).toLocaleString()," ر.س"]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"المدفوعات"}),e.jsxs("p",{className:"text-3xl font-bold text-green-600",children:[n.filter(t=>t.status==="paid").reduce((t,l)=>t+l.total,0).toLocaleString()," ر.س"]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"المستحقات"}),e.jsxs("p",{className:"text-3xl font-bold text-red-600",children:[n.filter(t=>t.status!=="paid").reduce((t,l)=>t+l.total,0).toLocaleString()," ر.س"]})]})]}),e.jsx("div",{className:"bg-white rounded-xl shadow-lg p-4 mb-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(j,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"البحث عن فاتورة...",value:d,onChange:t=>a(t.target.value),className:"w-full pr-10 pl-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400"})]}),e.jsxs("select",{value:o,onChange:t=>x(t.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400",children:[e.jsx("option",{value:"all",children:"جميع الحالات"}),e.jsx("option",{value:"paid",children:"مدفوع"}),e.jsx("option",{value:"pending",children:"معلق"}),e.jsx("option",{value:"overdue",children:"متأخر"})]})]})}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-right text-sm font-semibold text-gray-700",children:"رقم الفاتورة"}),e.jsx("th",{className:"px-6 py-4 text-right text-sm font-semibold text-gray-700",children:"المستأجر"}),e.jsx("th",{className:"px-6 py-4 text-right text-sm font-semibold text-gray-700",children:"المبلغ"}),e.jsx("th",{className:"px-6 py-4 text-right text-sm font-semibold text-gray-700",children:"الضريبة"}),e.jsx("th",{className:"px-6 py-4 text-right text-sm font-semibold text-gray-700",children:"الإجمالي"}),e.jsx("th",{className:"px-6 py-4 text-right text-sm font-semibold text-gray-700",children:"تاريخ الاستحقاق"}),e.jsx("th",{className:"px-6 py-4 text-right text-sm font-semibold text-gray-700",children:"الحالة"}),e.jsx("th",{className:"px-6 py-4 text-right text-sm font-semibold text-gray-700",children:"الإجراءات"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:r.map((t,l)=>e.jsxs(p.tr,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:l*.05},className:"hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4 font-medium text-gray-900",children:t.invoiceNumber}),e.jsx("td",{className:"px-6 py-4 text-gray-600",children:t.tenantName}),e.jsxs("td",{className:"px-6 py-4 text-gray-900",children:[t.amount.toLocaleString()," ر.س"]}),e.jsxs("td",{className:"px-6 py-4 text-gray-600",children:[t.tax.toLocaleString()," ر.س"]}),e.jsxs("td",{className:"px-6 py-4 font-medium text-gray-900",children:[t.total.toLocaleString()," ر.س"]}),e.jsx("td",{className:"px-6 py-4 text-gray-600",children:new Date(t.dueDate).toLocaleDateString("ar-SA")}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${t.status==="paid"?"bg-green-100 text-green-700":t.status==="pending"?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}`,children:t.status==="paid"?"مدفوع":t.status==="pending"?"معلق":"متأخر"})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>i(`/billing/view/${t.id}`),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"عرض",children:e.jsx(N,{className:"w-4 h-4"})}),e.jsx("button",{className:"p-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors",title:"تحميل",children:e.jsx(f,{className:"w-4 h-4"})})]})})]},t.id))})]})}),r.length===0&&e.jsx("div",{className:"text-center py-12 text-gray-500",children:"لا توجد فواتير متطابقة مع البحث"})]}),e.jsx(v,{isOpen:m,onClose:()=>s(!1)})]})}export{E as Billing};
