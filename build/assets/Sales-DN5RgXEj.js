import{c as M,r as d,j as e}from"./index-Ckv98okJ.js";import{B as m}from"./button-C9eQ0t7a.js";import{P as $}from"./plus-C9xzBu_X.js";import{c as y}from"./createLucideIcon-BSYcr9Kq.js";import{T as I}from"./trending-up-Y-YGQUj4.js";import{F as T}from"./file-text-BlJS6ccn.js";import{B}from"./building-2-DEbP7tbQ.js";import{S as A}from"./search-BGwozNRO.js";import{F}from"./funnel-lfaUbYFb.js";import{H as X}from"./house-D7y-fc29.js";import{E as _}from"./eye-CNuNKbIA.js";import{S as q}from"./square-pen-DcBg-tx1.js";import{T as O}from"./trash-2-DcHiZy9g.js";import{S as L}from"./shopping-cart-Bf3XHW6H.js";import{C as H}from"./chevron-right-EGWjRHRH.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],J=y("chevron-left",V);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],z=y("dollar-sign",R),b="arkan_sales_data",g=[{id:"sale-1",propertyName:"برج الأمل السكني",unitNo:"A-101",buyerName:"محمد أحمد العلي",buyerPhone:"0501234567",salePrice:85e4,saleDate:"2024-12-15",status:"completed",paymentMethod:"cash"},{id:"sale-2",propertyName:"مجمع النخيل التجاري",unitNo:"B-203",buyerName:"فهد سعد الحربي",buyerPhone:"0559876543",salePrice:12e5,saleDate:"2024-12-20",status:"completed",paymentMethod:"bank"},{id:"sale-3",propertyName:"فلل الياسمين",unitNo:"V-05",buyerName:"عبدالله خالد المطيري",buyerPhone:"0544567890",salePrice:25e5,saleDate:"2025-01-02",status:"pending",paymentMethod:"installment"}],G=()=>{try{const l=localStorage.getItem(b);if(l)return JSON.parse(l)}catch(l){console.error("Error loading sales from localStorage:",l)}return localStorage.setItem(b,JSON.stringify(g)),g},K=l=>{try{localStorage.setItem(b,JSON.stringify(l))}catch(u){console.error("Error saving sales to localStorage:",u)}};function ce(){const{properties:l,units:u}=M(),[n,c]=d.useState([]),[x,N]=d.useState(""),[j,i]=d.useState(!1);d.useEffect(()=>{const s=G();c(s)},[]),d.useEffect(()=>{n.length>0&&K(n)},[n]);const[t,a]=d.useState({propertyName:"",unitNo:"",buyerName:"",buyerPhone:"",buyerId:"",buyerEmail:"",salePrice:"",saleDate:new Date().toISOString().split("T")[0],paymentMethod:"cash",status:"pending",notes:""}),h=()=>{a({propertyName:"",unitNo:"",buyerName:"",buyerPhone:"",buyerId:"",buyerEmail:"",salePrice:"",saleDate:new Date().toISOString().split("T")[0],paymentMethod:"cash",status:"pending",notes:""})},f=s=>{if(s.preventDefault(),!t.propertyName||!t.unitNo||!t.buyerName||!t.salePrice){alert("الرجاء ملء جميع الحقول المطلوبة");return}const r={id:`sale-${Date.now()}`,propertyName:t.propertyName,unitNo:t.unitNo,buyerName:t.buyerName,buyerPhone:t.buyerPhone,salePrice:parseFloat(t.salePrice),saleDate:t.saleDate,status:t.status,paymentMethod:t.paymentMethod,notes:t.notes};c(o=>[r,...o]),h(),i(!1),alert("تم إضافة عملية البيع بنجاح! ✓")},v=s=>{alert(`تفاصيل البيع:

العقار: ${s.propertyName}
الوحدة: ${s.unitNo}
المشتري: ${s.buyerName}
الهاتف: ${s.buyerPhone}
السعر: ${s.salePrice.toLocaleString()} ر.س
التاريخ: ${s.saleDate}
الحالة: ${s.status==="completed"?"مكتمل":s.status==="pending"?"قيد الانتظار":"ملغي"}
${s.notes?"ملاحظات: "+s.notes:""}`)},w=s=>{a({propertyName:s.propertyName,unitNo:s.unitNo,buyerName:s.buyerName,buyerPhone:s.buyerPhone,buyerId:"",buyerEmail:"",salePrice:s.salePrice.toString(),saleDate:s.saleDate,paymentMethod:s.paymentMethod,status:s.status,notes:s.notes||""}),c(r=>r.filter(o=>o.id!==s.id)),i(!0)},S=s=>{confirm(`هل أنت متأكد من حذف عملية البيع للمشتري "${s.buyerName}"؟`)&&(c(r=>r.filter(o=>o.id!==s.id)),alert("تم حذف عملية البيع بنجاح"))},P=n.filter(s=>s.status==="completed").reduce((s,r)=>s+r.salePrice,0),C=n.filter(s=>s.status==="pending").length,D=n.filter(s=>s.status==="completed").length,p=n.filter(s=>s.propertyName.includes(x)||s.buyerName.includes(x)||s.unitNo.includes(x)),k=s=>{const r={pending:"bg-yellow-100 text-yellow-700",completed:"bg-green-100 text-green-700",cancelled:"bg-red-100 text-red-700"},o={pending:"قيد الانتظار",completed:"مكتملة",cancelled:"ملغية"};return e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${r[s]}`,children:o[s]})},E=s=>{const r={cash:"نقداً",installment:"أقساط",bank:"تحويل بنكي"};return e.jsx("span",{className:"px-2 py-1 rounded bg-gray-100 text-gray-600 text-xs",children:r[s]})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-brand-dark mb-1",children:"المبيعات"}),e.jsx("p",{className:"text-gray-500",children:"إدارة عمليات البيع والفواتير"})]}),e.jsxs(m,{onClick:()=>i(!0),className:"gap-2",children:[e.jsx($,{className:"w-4 h-4"}),"إضافة عملية بيع"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx("div",{className:"bg-white rounded-2xl shadow-lg p-6 border border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"إجمالي المبيعات"}),e.jsxs("p",{className:"text-2xl font-bold text-brand-dark",children:[P.toLocaleString()," ",e.jsx("span",{className:"text-sm text-gray-400",children:"ر.س"})]})]}),e.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center",children:e.jsx(z,{className:"w-6 h-6 text-green-600"})})]})}),e.jsx("div",{className:"bg-white rounded-2xl shadow-lg p-6 border border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"عمليات مكتملة"}),e.jsx("p",{className:"text-2xl font-bold text-brand-dark",children:D})]}),e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center",children:e.jsx(I,{className:"w-6 h-6 text-blue-600"})})]})}),e.jsx("div",{className:"bg-white rounded-2xl shadow-lg p-6 border border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"قيد الانتظار"}),e.jsx("p",{className:"text-2xl font-bold text-brand-dark",children:C})]}),e.jsx("div",{className:"w-12 h-12 bg-yellow-100 rounded-xl flex items-center justify-center",children:e.jsx(T,{className:"w-6 h-6 text-yellow-600"})})]})}),e.jsx("div",{className:"bg-white rounded-2xl shadow-lg p-6 border border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"العقارات المتاحة"}),e.jsx("p",{className:"text-2xl font-bold text-brand-dark",children:l.length})]}),e.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-xl flex items-center justify-center",children:e.jsx(B,{className:"w-6 h-6 text-purple-600"})})]})})]}),e.jsx("div",{className:"bg-white rounded-2xl shadow-lg p-6 border border-gray-100",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(A,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"البحث عن عملية بيع...",value:x,onChange:s=>N(s.target.value),className:"w-full pr-10 pl-4 py-3 rounded-xl border border-gray-200 focus:border-brand-blue focus:ring-2 focus:ring-brand-blue/20 outline-none transition-all"})]}),e.jsxs(m,{variant:"outline",className:"gap-2",children:[e.jsx(F,{className:"w-4 h-4"}),"فلترة"]})]})}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-right py-4 px-6 text-sm font-semibold text-gray-600",children:"العقار"}),e.jsx("th",{className:"text-right py-4 px-6 text-sm font-semibold text-gray-600",children:"الوحدة"}),e.jsx("th",{className:"text-right py-4 px-6 text-sm font-semibold text-gray-600",children:"المشتري"}),e.jsx("th",{className:"text-right py-4 px-6 text-sm font-semibold text-gray-600",children:"السعر"}),e.jsx("th",{className:"text-right py-4 px-6 text-sm font-semibold text-gray-600",children:"طريقة الدفع"}),e.jsx("th",{className:"text-right py-4 px-6 text-sm font-semibold text-gray-600",children:"التاريخ"}),e.jsx("th",{className:"text-right py-4 px-6 text-sm font-semibold text-gray-600",children:"الحالة"}),e.jsx("th",{className:"text-right py-4 px-6 text-sm font-semibold text-gray-600",children:"الإجراءات"})]})}),e.jsx("tbody",{children:p.length>0?p.map(s=>e.jsxs("tr",{className:"border-b border-gray-50 hover:bg-gray-50/50 transition-colors",children:[e.jsx("td",{className:"py-4 px-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-brand-light rounded-lg flex items-center justify-center",children:e.jsx(X,{className:"w-5 h-5 text-brand-blue"})}),e.jsx("span",{className:"font-medium text-gray-800",children:s.propertyName})]})}),e.jsx("td",{className:"py-4 px-6 text-gray-600",children:s.unitNo}),e.jsx("td",{className:"py-4 px-6",children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-800",children:s.buyerName}),e.jsx("p",{className:"text-sm text-gray-500",children:s.buyerPhone})]})}),e.jsxs("td",{className:"py-4 px-6 font-semibold text-brand-dark",children:[s.salePrice.toLocaleString()," ر.س"]}),e.jsx("td",{className:"py-4 px-6",children:E(s.paymentMethod)}),e.jsx("td",{className:"py-4 px-6 text-gray-600",children:s.saleDate}),e.jsx("td",{className:"py-4 px-6",children:k(s.status)}),e.jsx("td",{className:"py-4 px-6",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>v(s),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",title:"عرض التفاصيل",children:e.jsx(_,{className:"w-4 h-4 text-gray-500"})}),e.jsx("button",{onClick:()=>w(s),className:"p-2 hover:bg-blue-50 rounded-lg transition-colors",title:"تعديل",children:e.jsx(q,{className:"w-4 h-4 text-blue-500"})}),e.jsx("button",{onClick:()=>S(s),className:"p-2 hover:bg-red-50 rounded-lg transition-colors",title:"حذف",children:e.jsx(O,{className:"w-4 h-4 text-red-500"})})]})})]},s.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"py-12 text-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center",children:e.jsx(L,{className:"w-8 h-8 text-gray-400"})}),e.jsx("p",{className:"text-gray-500",children:"لا توجد عمليات بيع"})]})})})})]})}),e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-t border-gray-100",children:[e.jsxs("p",{className:"text-sm text-gray-500",children:["عرض ",p.length," من ",n.length," عمليات"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{className:"p-2 hover:bg-gray-100 rounded-lg transition-colors disabled:opacity-50",children:e.jsx(H,{className:"w-5 h-5 text-gray-500"})}),e.jsx("span",{className:"px-3 py-1 bg-brand-blue text-white rounded-lg text-sm",children:"1"}),e.jsx("button",{className:"p-2 hover:bg-gray-100 rounded-lg transition-colors disabled:opacity-50",children:e.jsx(J,{className:"w-5 h-5 text-gray-500"})})]})]})]}),j&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl p-8 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-bold text-brand-dark",children:"إضافة عملية بيع جديدة"}),e.jsx("button",{onClick:()=>{i(!1),h()},className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:"✕"})]}),e.jsxs("form",{onSubmit:f,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"العقار *"}),e.jsxs("select",{value:t.propertyName,onChange:s=>a({...t,propertyName:s.target.selectedOptions[0]?.text||""}),className:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-brand-blue focus:ring-2 focus:ring-brand-blue/20 outline-none transition-all",required:!0,children:[e.jsx("option",{value:"",children:"اختر العقار"}),l.map(s=>e.jsx("option",{value:s.name,children:s.name},s.id)),e.jsx("option",{value:"برج الأمل السكني",children:"برج الأمل السكني"}),e.jsx("option",{value:"مجمع النخيل التجاري",children:"مجمع النخيل التجاري"}),e.jsx("option",{value:"فلل الياسمين",children:"فلل الياسمين"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"الوحدة *"}),e.jsxs("select",{value:t.unitNo,onChange:s=>a({...t,unitNo:s.target.value}),className:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-brand-blue focus:ring-2 focus:ring-brand-blue/20 outline-none transition-all",required:!0,children:[e.jsx("option",{value:"",children:"اختر الوحدة"}),u.filter(s=>s.status==="vacant").map(s=>e.jsx("option",{value:s.unitNo,children:s.unitNo},s.id)),e.jsx("option",{value:"A-102",children:"A-102"}),e.jsx("option",{value:"B-205",children:"B-205"}),e.jsx("option",{value:"V-08",children:"V-08"})]})]})]}),e.jsxs("div",{className:"border-t pt-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"معلومات المشتري"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"اسم المشتري *"}),e.jsx("input",{type:"text",placeholder:"الاسم الكامل",value:t.buyerName,onChange:s=>a({...t,buyerName:s.target.value}),className:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-brand-blue focus:ring-2 focus:ring-brand-blue/20 outline-none transition-all",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"رقم الهاتف"}),e.jsx("input",{type:"tel",placeholder:"05XXXXXXXX",value:t.buyerPhone,onChange:s=>a({...t,buyerPhone:s.target.value}),className:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-brand-blue focus:ring-2 focus:ring-brand-blue/20 outline-none transition-all"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"رقم الهوية"}),e.jsx("input",{type:"text",placeholder:"رقم الهوية الوطنية",value:t.buyerId,onChange:s=>a({...t,buyerId:s.target.value}),className:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-brand-blue focus:ring-2 focus:ring-brand-blue/20 outline-none transition-all"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"البريد الإلكتروني"}),e.jsx("input",{type:"email",placeholder:"email@example.com",value:t.buyerEmail,onChange:s=>a({...t,buyerEmail:s.target.value}),className:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-brand-blue focus:ring-2 focus:ring-brand-blue/20 outline-none transition-all"})]})]})]}),e.jsxs("div",{className:"border-t pt-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"تفاصيل البيع"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"سعر البيع *"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",placeholder:"0",value:t.salePrice,onChange:s=>a({...t,salePrice:s.target.value}),className:"w-full px-4 py-3 pl-16 rounded-xl border border-gray-200 focus:border-brand-blue focus:ring-2 focus:ring-brand-blue/20 outline-none transition-all",required:!0}),e.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 text-sm",children:"ر.س"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"تاريخ البيع"}),e.jsx("input",{type:"date",value:t.saleDate,onChange:s=>a({...t,saleDate:s.target.value}),className:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-brand-blue focus:ring-2 focus:ring-brand-blue/20 outline-none transition-all"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"طريقة الدفع"}),e.jsxs("select",{value:t.paymentMethod,onChange:s=>a({...t,paymentMethod:s.target.value}),className:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-brand-blue focus:ring-2 focus:ring-brand-blue/20 outline-none transition-all",children:[e.jsx("option",{value:"cash",children:"نقداً"}),e.jsx("option",{value:"bank",children:"تحويل بنكي"}),e.jsx("option",{value:"installment",children:"أقساط"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"الحالة"}),e.jsxs("select",{value:t.status,onChange:s=>a({...t,status:s.target.value}),className:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-brand-blue focus:ring-2 focus:ring-brand-blue/20 outline-none transition-all",children:[e.jsx("option",{value:"pending",children:"قيد الانتظار"}),e.jsx("option",{value:"completed",children:"مكتملة"})]})]})]}),e.jsxs("div",{className:"mt-4 space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"ملاحظات"}),e.jsx("textarea",{rows:3,placeholder:"أي ملاحظات إضافية...",value:t.notes,onChange:s=>a({...t,notes:s.target.value}),className:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-brand-blue focus:ring-2 focus:ring-brand-blue/20 outline-none transition-all resize-none"})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4 border-t",children:[e.jsx(m,{type:"button",onClick:()=>{i(!1),h()},variant:"outline",className:"flex-1",children:"إلغاء"}),e.jsx(m,{type:"submit",className:"flex-1",children:"حفظ عملية البيع"})]})]})]})})]})}export{ce as Sales};
