import{c as C,r as p,j as e,t as b,a as D,m as E,L as M}from"./index-mGwfGQYQ.js";import{D as T,a as L,b as U,c as $}from"./dialog-D60cBJNC.js";import{B as f}from"./button-obQTf0hL.js";import{X as B}from"./x-BRS87iRj.js";import{U as I}from"./upload-C3q5xn9y.js";import{P as w}from"./plus-B5-QUGQk.js";import{S as O}from"./search-Sd1l6yxc.js";import{M as F}from"./map-pin-CdpOq60y.js";import{S as H}from"./square-pen-CVcJ4uLN.js";import{T as R}from"./trash-2-Duj4ao2x.js";import{H as Y}from"./house-JsTtFKRL.js";import{B as _}from"./building-2-D4S1PQka.js";import"./utils-Bp-GuQk1.js";import"./createLucideIcon-_jMiD3q_.js";const q=["الرياض","جدة","مكة المكرمة","المدينة المنورة","الدمام","الخبر","الظهران","تبوك","أبها","الطائف"],z=[{value:"building",label:"مبنى سكني"},{value:"villa",label:"فيلا"},{value:"complex",label:"مجمع سكني"},{value:"land",label:"أرض"}];function A({isOpen:d,onClose:x,propertyId:i}){const{properties:c,addProperty:j,updateProperty:m}=C(),[l,n]=p.useState({name:"",city:"الرياض",address:"",type:"building",images:[]});p.useEffect(()=>{if(i){const t=c.find(r=>r.id===i);t&&n({name:t.name,city:t.city,address:t.address,type:t.type,images:t.images||[]})}else n({name:"",city:"الرياض",address:"",type:"building",images:[]})},[i,c,d]);const g=t=>{if(t.preventDefault(),!l.name||!l.address){b.error("الرجاء إدخال جميع الحقول المطلوبة");return}i?(m(i,l),b.success("تم تحديث العقار بنجاح")):(j(l),b.success("تم إضافة العقار بنجاح")),x()},v=()=>{const t=["https://images.unsplash.com/photo-1545324418-cc1a3fa10c00?w=800","https://images.unsplash.com/photo-1512917774080-9991f1c4c750?w=800","https://images.unsplash.com/photo-1486406146926-c627a92ad1ab?w=800","https://images.unsplash.com/photo-1560448204-e02f11c3d0e2?w=800"],r=t[Math.floor(Math.random()*t.length)];n({...l,images:[...l.images,r]}),b.success("تم رفع الصورة")},u=t=>{n({...l,images:l.images.filter((r,y)=>y!==t)})};return e.jsx(T,{open:d,onOpenChange:x,children:e.jsxs(L,{className:"max-w-lg",children:[e.jsx(U,{children:e.jsx($,{children:i?"تعديل العقار":"إضافة عقار جديد"})}),e.jsxs("form",{onSubmit:g,className:"space-y-4 mt-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["اسم العقار ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:l.name,onChange:t=>n({...l,name:t.target.value}),className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-brand-blue/20 focus:border-brand-blue",placeholder:"مثال: برج الياسمين"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["نوع العقار ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("select",{value:l.type,onChange:t=>n({...l,type:t.target.value}),className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-brand-blue/20 focus:border-brand-blue bg-white",children:z.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["المدينة ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("select",{value:l.city,onChange:t=>n({...l,city:t.target.value}),className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-brand-blue/20 focus:border-brand-blue bg-white",children:q.map(t=>e.jsx("option",{value:t,children:t},t))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["العنوان ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:l.address,onChange:t=>n({...l,address:t.target.value}),className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-brand-blue/20 focus:border-brand-blue",placeholder:"مثال: حي النرجس، شارع التخصصي"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"الصور"}),l.images.length>0&&e.jsx("div",{className:"grid grid-cols-4 gap-2 mb-3",children:l.images.map((t,r)=>e.jsxs("div",{className:"relative group",children:[e.jsx("img",{src:t,alt:`صورة ${r+1}`,className:"w-full h-16 object-cover rounded-lg"}),e.jsx("button",{type:"button",onClick:()=>u(r),className:"absolute top-1 left-1 p-1 bg-red-500 text-white rounded-full opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(B,{className:"w-3 h-3"})})]},r))}),e.jsxs("button",{type:"button",onClick:v,className:"w-full px-4 py-2 border-2 border-dashed border-gray-300 rounded-xl hover:border-brand-blue transition-colors flex items-center justify-center gap-2 text-gray-600 hover:text-brand-blue text-sm",children:[e.jsx(I,{className:"w-4 h-4"}),e.jsx("span",{children:"رفع صورة"})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(f,{type:"submit",variant:"gradient",className:"flex-1",children:i?"حفظ التعديلات":"إضافة العقار"}),e.jsx(f,{type:"button",variant:"outline",onClick:x,children:"إلغاء"})]})]})]})})}function ne(){const{properties:d,units:x,deleteProperty:i}=C();D();const[c,j]=p.useState(""),[m,l]=p.useState("all"),[n,g]=p.useState(!1),[v,u]=p.useState(null),t=s=>{const o=x.filter(N=>N.propertyId===s),a=o.length,h=o.filter(N=>N.status==="rented").length,P=a>0?Math.round(h/a*100):0;return{total:a,rented:h,occupancy:P}},r=d.filter(s=>{const o=s.name.toLowerCase().includes(c.toLowerCase())||s.city.toLowerCase().includes(c.toLowerCase()),a=m==="all"||s.city===m;return o&&a}),y=["all",...Array.from(new Set(d.map(s=>s.city)))],k=s=>{u(s),g(!0)},S=s=>{const o=d.find(h=>h.id===s),a=x.filter(h=>h.propertyId===s);if(a.length>0){b.error(`لا يمكن حذف "${o?.name}" لأنه يحتوي على ${a.length} وحدة`);return}confirm(`هل أنت متأكد من حذف "${o?.name}"؟`)&&(i(s),b.success("تم حذف العقار بنجاح"))};return e.jsxs("div",{className:"space-y-4 lg:space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[e.jsx("div",{children:e.jsxs("p",{className:"text-sm lg:text-base text-gray-600",children:["إدارة جميع العقارات والمباني (",d.length," عقار)"]})}),e.jsxs(f,{onClick:()=>{u(null),g(!0)},variant:"gradient",className:"w-full sm:w-auto text-sm lg:text-base",children:[e.jsx(w,{className:"w-4 h-4 lg:w-5 lg:h-5 ml-2"}),"إضافة عقار جديد"]})]}),e.jsx("div",{className:"bg-white rounded-xl shadow-lg p-3 lg:p-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 lg:gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(O,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4 lg:w-5 lg:h-5"}),e.jsx("input",{type:"text",placeholder:"البحث عن عقار...",value:c,onChange:s=>j(s.target.value),className:"w-full pr-9 lg:pr-10 pl-3 lg:pl-4 py-2.5 lg:py-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-brand-blue/20 focus:border-brand-blue transition-all text-sm lg:text-base"})]}),e.jsxs("select",{value:m,onChange:s=>l(s.target.value),className:"px-3 lg:px-4 py-2.5 lg:py-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-brand-blue/20 focus:border-brand-blue bg-white transition-all text-sm lg:text-base",children:[e.jsx("option",{value:"all",children:"جميع المدن"}),y.filter(s=>s!=="all").map(s=>e.jsx("option",{value:s,children:s},s))]})]})}),r.length>0?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 lg:gap-6",children:r.map((s,o)=>{const a=t(s.id);return e.jsxs(E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:o*.05},className:"bg-white rounded-xl lg:rounded-2xl shadow-lg overflow-hidden hover:shadow-xl transition-all duration-300 group",children:[e.jsxs("div",{className:"relative h-36 sm:h-40 lg:h-48 overflow-hidden",children:[e.jsx("img",{src:s.images[0]||"https://images.unsplash.com/photo-1486406146926-c627a92ad1ab?w=800",alt:s.name,className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-500"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 to-transparent"}),e.jsxs("div",{className:"absolute bottom-3 lg:bottom-4 right-3 lg:right-4 left-3 lg:left-4",children:[e.jsx("h3",{className:"text-white font-bold text-base lg:text-lg mb-1",children:s.name}),e.jsxs("div",{className:"flex items-center gap-1 text-white/80 text-xs lg:text-sm",children:[e.jsx(F,{className:"w-3 h-3 lg:w-4 lg:h-4"}),e.jsx("span",{children:s.city})]})]}),e.jsx("div",{className:"absolute top-3 lg:top-4 left-3 lg:left-4",children:e.jsx("span",{className:"px-2 lg:px-3 py-1 bg-white/90 backdrop-blur rounded-full text-[10px] lg:text-xs font-medium text-brand-dark",children:s.type==="building"?"مبنى":s.type==="villa"?"فيلا":s.type==="complex"?"مجمع":"أرض"})})]}),e.jsxs("div",{className:"p-3 lg:p-5",children:[e.jsx("p",{className:"text-gray-500 text-xs lg:text-sm mb-3 lg:mb-4 line-clamp-2",children:s.address}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 lg:gap-3 mb-3 lg:mb-4",children:[e.jsxs("div",{className:"text-center p-1.5 lg:p-2 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"text-base lg:text-lg font-bold text-brand-dark",children:a.total}),e.jsx("div",{className:"text-[10px] lg:text-xs text-gray-500",children:"وحدة"})]}),e.jsxs("div",{className:"text-center p-1.5 lg:p-2 bg-green-50 rounded-lg",children:[e.jsx("div",{className:"text-base lg:text-lg font-bold text-green-600",children:a.rented}),e.jsx("div",{className:"text-[10px] lg:text-xs text-gray-500",children:"مؤجرة"})]}),e.jsxs("div",{className:"text-center p-1.5 lg:p-2 bg-blue-50 rounded-lg",children:[e.jsxs("div",{className:"text-base lg:text-lg font-bold text-brand-blue",children:[a.occupancy,"%"]}),e.jsx("div",{className:"text-[10px] lg:text-xs text-gray-500",children:"إشغال"})]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-3 lg:pt-4 border-t border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>k(s.id),className:"p-1.5 lg:p-2 text-gray-400 hover:text-brand-blue hover:bg-brand-blue/10 rounded-lg transition-colors",title:"تعديل",children:e.jsx(H,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>S(s.id),className:"p-1.5 lg:p-2 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors",title:"حذف",children:e.jsx(R,{className:"w-4 h-4"})})]}),e.jsx(M,{to:`/app/units?property=${s.id}`,children:e.jsxs(f,{variant:"outline",size:"sm",className:"text-xs lg:text-sm px-2 lg:px-3",children:[e.jsx(Y,{className:"w-3 h-3 lg:w-4 lg:h-4 ml-1"}),"الوحدات"]})})]})]})]},s.id)})}):e.jsxs("div",{className:"bg-white rounded-xl lg:rounded-2xl shadow-lg p-8 lg:p-12 text-center",children:[e.jsx("div",{className:"w-16 h-16 lg:w-20 lg:h-20 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(_,{className:"w-8 h-8 lg:w-10 lg:h-10 text-gray-400"})}),e.jsx("h3",{className:"text-lg lg:text-xl font-bold text-gray-700 mb-2",children:"لا توجد عقارات"}),e.jsx("p",{className:"text-sm lg:text-base text-gray-500 mb-6",children:c||m!=="all"?"لا توجد نتائج تطابق البحث":"ابدأ بإضافة عقارك الأول"}),!c&&m==="all"&&e.jsxs(f,{onClick:()=>{u(null),g(!0)},variant:"gradient",children:[e.jsx(w,{className:"w-5 h-5 ml-2"}),"إضافة عقار جديد"]})]}),e.jsx(A,{isOpen:n,onClose:()=>{g(!1),u(null)},propertyId:v})]})}export{ne as Properties};
